\hypertarget{OutputFiles}{}
\section[Output Files]{\protect\hyperlink{OutputFiles}{Output Files}}

\hypertarget{CustomReporting}{}
\subsection[Custom Reporting]{\protect\hyperlink{CustomReporting}{Custom Reporting}}
\hypertarget{custom}{} 
Additional user control for what is included in the \texttt{Report.sso} file was added in v.3.30.16. This approach allows for full customizing of what is printed to the Report file by selecting custom reporting (option = 3) in the starter file where specific items now can be included or excluded depending upon a list passed to SS3 from the starter file. The numbering system for each item in the Report file is as follows:

\begin{center}
	\begin{longtable}{p{1cm} p{6.5cm}p{1cm} p{6cm}}
		\hline
		Num. & Report Item & Num. & Report Item \Tstrut\Bstrut\\
		\hline
1	& DEFINITIONS				    &	31	&	LEN	SELEX \\			
2	& LIKELIHOOD					&	32	&	AGE	SELEX \\			
3	& Input Variance Adjustment	    &	33	&	ENVIRONMENTAL	DATA \\			
4	& Parm devs detail			    &	34	&	TAG	Recapture \\			
5	& PARAMETERS					&	35	&	NUMBERS-AT-AGE \\				
6	& DERIVED	QUANTITIES			&	36	&	BIOMASS-AT-AGE \\				
7	& MGparm By Year after adjustments &	37	& NUMBERS-AT-LENGTH	\\				
8	& selparm(Size) By Year after adjustments & 38 & BIOMASS-AT-LENGTH \\				
9	& selparm(Age) By Year after adjustments  &	39 & F-AT-AGE \\				
10	& RECRUITMENT	DIST			&	40	& CATCH-AT-AGE \\				
11	& MORPH	INDEXING				&	41	& DISCARD-AT-AGE \\				
12	& SIZEFREQ	TRANSLATION			&	42	&	BIOLOGY	\\				
13	& MOVEMENT					    &	43	&	Natural	Mortality \\			
14	& EXPLOITATION					&	44	&	AGE	SPECIFIC	K \\		
15	& CATCH					        &	45	&	Growth	Parameters \\			
16	& TIME	SERIES				    &	46	&	Seas	Effects	\\			
17	& SPR	SERIES				    &	47	&	Biology	at	age	in	endyr \\
18	& Kobe	Plot				    &	48	&	MEAN	BODY	WT(Begin) \\		
19	& SPAWN	RECRUIT				    &	49	&	MEAN	SIZE	TIMESERIES \\		
20	& SPAWN	RECR	CURVE			&	50	&	AGE	LENGTH	KEY	\\		
21	& INDEX	1				        &	51	&	AGE	AGE	KEY	\\		
22	& INDEX	2				        &	52	&	COMPOSITION	DATABASE \\			
23	& INDEX	3				        &	53	&	SELEX	database \\			
24	& DISCARD	SPECIFICATION		&	54	&	SPR/YPR	Profile	\\			
25	& DISCARD	OUTPUT				&	55	&	GLOBAL	MSY	\\			
26	& MEAN	BODY	WT	OUTPUT		&	56	&	\texttt{SS\_summary.sso} \\				
27	& FIT	LEN	COMPS			    &	57	&	\texttt{rebuilder.sso} \\				
28	& FIT	AGE	COMPS			    &	58	&	\texttt{SIStable.sso} \\				
29	& FIT	SIZE	COMPS			&	59	&	Dynamic	Bzero \\			
30	& OVERALL	COMPS				&	60	&	\texttt{wtatage.ss\_new}	\\				
\hline
	\end{longtable}
\end{center}

\hypertarget{ADMBOutput}{}
\subsection[Standard ADMB output files]{\protect\hyperlink{ADMBOutput}{Standard ADMB output files}}
Standard \gls{admb} files are created by SS3. These are:

\texttt{ss3.par} (previously \texttt{ss.par}) - This file has the final parameter values. They are listed in the order they are declared in SS3. This file can be read back into SS3 to restart a run with these values (see \hyperref[sec:RunningSS3]{Running Stock Synthesis} for more info).

\texttt{ss.std} - This file has the parameter values and their estimated standard deviation for those parameters that were active during the model run. It also contains the derived quantities declared as standard deviation report variables. All of this information is also reported in the \texttt{covar.sso}. Also, the parameter section of \texttt{Report.sso} lists all the parameters with their SS3 generated names, denotes which were active in the reported run, displays the parameter standard deviations, then displays the derived quantities with their standard deviations.

\texttt{ss.rep} - This report file is created between phases so, unlike \texttt{Report.sso}, will be created even if the hessian fails. It does not contain as much output as shown in \texttt{Report.sso}.

\texttt{ss.cor} - This is the standard \gls{admb} report for parameter and standard deviation report correlations. It is in matrix form and challenging to interpret. This same information is reported in \texttt{covar.sso}.

\hypertarget{SS3Summary}{}
\subsection[Stock Synthesis Summary]{\protect\hyperlink{SS3Summary}{Stock Synthesis Summary}}
The \texttt{ss\_summary.sso} file (available for versions 3.30.08.03 and later) is designed to put key model outputs all in one concise place. It is organized as a list. At the top of the file are descriptors, followed by the 1) likelihoods for each component, 2) parameters and their standard errors, and 3) derived quantities and their standard errors. Total biomass, summary biomass, and catch were added to the quantities reported in this file in v.3.30.11 and later.

Before v.3.30.17, TotBio and SmryBio did not always match values reported in columns of the TIME\_SERIES table of \texttt{Report.sso}. The report file should be used instead of \texttt{ss\_summary.sso} for correct calculation of these quantities before v.3.30.17. Care should be taken when using the TotBio and SmryBio if the model configuration has recruitment after January 1 or in a later season, as TotBio and SmryBio quantities are always calculated on January 1. Consult the detailed age-, area-, and season-specific tables in \texttt{Report.sso} for calculations done at times other than January 1.

\hypertarget{SIStable}{}
\subsection[SIS table]{\protect\hyperlink{SIStable}{SIS table}}
The \texttt{SIS\_table.sso} is deprecated as of v.3.30.17. Please use the \hyperref[sec:r4ss]{\gls{r4ss}} function \texttt{get\_SIS\_info()} instead. 

The \texttt{SIS\_table.sso} file contains model output formatted for reading into the \gls{nmfs} \href{https://www.st.nmfs.noaa.gov/sis/}{\gls{sis}}. This file includes an assessment summary for categories of information (abundance, recruitment, spawners, catch estimates) that are input into the \gls{sis} database. A time series of estimated quantities which aggregates estimates across multiple areas and seasons are provided to summarize model results. Access to the \gls{sis} database is granted to all \gls{noaa} employees.

\hypertarget{DerivedQuant}{}
\subsection[Derived Quantities]{\protect\hyperlink{DerivedQuant}{Derived Quantities}}
Before listing the derived quantities reported to the standard deviation report, there are a couple of topics that deserve further explanation.

\hypertarget{VirginUnfished}{}
\subsubsection[Virgin Spawning Biomass vs. Unfished Spawning Biomass]{\protect\hyperlink{VirginUnfishedVirginUnfished}{Virgin Spawning Biomass vs. Unfished Spawning Biomass}}
Unfished is the condition for which reference points (benchmark) are calculated. Virgin Spawning Biomass (B0) is the initial condition on which the start of the time-series depends. If biology or spawner-recruitment parameters are time-varying, then the benchmark year input in the forecast file tells the model which years to average in order to calculate ``unfished''. In this case, virgin recruitment and/or the virgin spawning biomass will differ from their unfished counterparts. Virgin recruitment and spawning biomass are reported in the mgmt\_quant portion of the sd\_report and are now labeled as ``unfished'' for clarity. Note that if ln(R0) is time-varying, then this will cause unfished to differ from virgin. However, if regime shift parameter is time-varying, then unfished will remain the same as virgin because the regime shift is treated as a temporary offset from virgin. Virgin spawning biomass is denoted as SPB\_virgin and spawning biomass unfished is denoted as SPB\_unf in the report file.

Virgin Spawning Biomass (B0) is used in four ways within SS3:
\begin{enumerate}
	\item Anchor for the spawner-recruitment relationship as virgin spawning biomass.
	\item Basis for the initial equilibrium abundance. 
	\item Basis against which annual depletion is calculated.
	\item Benchmark calculations.
\end{enumerate}
However, if there is time-varying biology, then the 4th usage can have a different B0 calculation compared to the other usages.

\hypertarget{FMortality}{}
\subsubsection[Metrics for Fishing Mortality]{\protect\hyperlink{FMortality}{Metrics for Fishing Mortality}}
\myparagraph{Annual Fishing Intensity}
Fishery management systems expect to have a measure of annual fishing mortality that describes the intensity of the fishery such that an optimal level of $F$ can be articulated, and accountability measures can be invoked if $F$ is too high, e.g., overfishing. This concept is simple and straightforward if the model is a simple biomass dynamics such that a single annual $F$ value operates on the entirety of a non-age structured population. It also is simple for age-structured models that have a single fishing fleet and knife-edge selectivity beginning at some specified age.

The simplicity of $F$ disappears quickly as models invoke a variety of realistic complexities such as: allowing the $F$ to differ among ages or to be based on size; using a collection of fleets with different $F$ levels and different age patterns for $F$; spreading the population across areas and allowing different fleets with different $F$ among the areas. An unambiguous measure of annual fishing intensity that represents the cumulative effect of all that complexity has not been defined. This problem has not been solved with SS3, but some logical alternatives have been made available. Two complementary approaches are reported: \gls{spr} shows the long-term effect of fishing on the stockâ€™s spawning potential, $F\text{\_std}$ shows a statistic related to the fraction of the population removed each year. The various options for both of these are found in the \texttt{starter.ss} file and described in that section of this manual. $F\text{std}_y$ is reported in the derived quantities, so variance is calculated for this quantity.

\myparagraph{Additional $F$ output}

The $F$ statistics are displayed most explicitly in the \texttt{Report.sso} table ``EXPLOITATION report:14''. There, the table columns are:
\begin{quote}
	\begin{verbatim}
	Yr Seas Seas\_dur F\_std annual\_F annual\_M <each fleet's F\_scalar>
	\end{verbatim}
\end{quote}

In this table, the displayed value for $\text{annual\_}F$ will be from the $F=Z-M$ method regardless of which option was chosen for $F\text{\_std}$. If $F\text{\_std}$ uses option 4 or 5, then the $\text{annual\_}F$ will use the same range of ages. Otherwise, $\text{annual\_}F$ will be for the age that is the mid-age of the age range of the model.

%The options are:
%\begin{itemize}
%	\item 0 = skip
%	\item 1 = exploitation(Bio)
%	\item 2 = exploitation(Num)
%	\item 3 = sum(Frates)
%\end{itemize}
%The exploitation rates are calculated as the ratio of the total annual catch (in either biomass or numbers as specified) to the summary biomass or summary numbers on January 1. The sum of the $F$ rates is simply the sum of all the $\text{full\_}F$s. This makes sense if the F method is in terms of instantaneous $F$ (not Pope's approximation) and if there are not fleets with widely different size/age at peak selectivity, and if there is no seasonality, and especially if there is only one area. 

%$F\text{\_std}$ is a single annual value based on $\text{ann}F$ and the relationship to $\text{ann}F$ is specified by F\_report\_basis in the starter.ss file. The benchmark $\text{ann}F$ may be used to rescale the time series of $\text{ann}F$s to become a time series of standardized values representing the intensity of fishing, $F\text{\_std}$. The report basis (the available options for the denominator) is selected in the starter file as:

%\begin{itemize}
%	\item 0 = raw
%	\item 1 = F/F\textsubscript {SPR}
%	\item 2 = F/F\textsubscript {MSY}
%	\item 3 = F/F\textsubscript {Btarget}
%	\item >= 11  A new option to allow for the calculation of a multi-year trailing average in F was implemented in v.3.30.16. This option is triggered by appending the number of years to calculate the average across where an input of 1 or 11 would result in the SPR\textsubscript{target} with no changes. Alternatively a value of 21 would calculate $F$ as SPR\textsubscript{target} with a 2-year trailing average.
%\end{itemize}

\myparagraph{$F\text{-at-Age}$}
$F\text{-at-Age}$ for each fleet is presented in \texttt{Report.sso} as table 39. Its header looks like:
\begin{quote}
	\begin{verbatim}
	F\_AT\_AGE report:39
	Area Fleet Sex Morph Yr Seas Era 0 1 2
	\end{verbatim}
\end{quote}

In addition to the $F\_std$ and $\text{annual\_}F$ outputs, info on total $F\text{-at-Age}$ across all fleets is reported at the end of the \texttt{Report.sso} file. This section of the report calculates $Z\text{-at-Age}$ as $ln(N_{a+1,t+1}/N_{a,t})$. This is done for numbers at the beginning of each year and the N values are summed over all areas. It is done once using the fishing intensities as estimated (to get $Z\text{-at-Age}$), and once with the $F$ intensities set to 0.0 to get $M\text{-at-Age}$. This latter sequence also provides a measure of dynamic B0. The user can then subtract the table of $M\text{-at-Age/year}$ from the table of $Z\text{-at-Age/year}$ to get a table of $F\text{-at-Age/year}$. From this $\text{apical\_}F$, average $F$ over a range of ages, or other user-desired statistics could be calculated. The header for this table looks like:
\begin{quote}
	\begin{verbatim}
	Z\_AT\_AGE\_Annual\_2 With\_fishery
	Bio\_Pattern Sex Yr  0 1 2
	\end{verbatim}
\end{quote}

A more detailed report provides $Z$ for each area, bio group (sex, morph, platoon) and age. It is titled something like ``Report\_Z\_by\_area\_morph\_platoon\_1 No\_fishery''. This table is done with and without the $F$ turned on, so that pair pf reports could be processed to get total $F$ by area, bio, age.

\myparagraph{Relative $F$ and $F\text{mult}$}
The $F'$ is fleet-specific, so it is useful to have a concept of relative $F$, $\text{rel}F_f$, among fleets. In SS3, $\text{rel}F_f= F_{t,f}'/\sum_{f}^{}F_{t,f}'$ for a single time period $t$. In the benchmark and forecast routines, SS3 can calculate $\text{rel}F_f$ using $F_{t,f}'$ over a range of years, or the user can input custom $\text{rel}F$ values for benchmark and forecast in the \texttt{forecast.ss} file. Note that in a multi-season model setup, $\text{rel}F_f$ is implemented as $\text{rel}F_{s,f}$ where $s$ is the season. These get multiplied by season duration as they are used.

In the benchmark section of the code, SS3 searches for an $F\text{mult}$ to achieve various management reference points (often referred to as benchmarks). In this search, SS3 calculates a benchmark $F$ as $F_{ben,f}' = F\text{mult} * \text{rel}F_f$, then calculates equilibrium yield and spawning biomass per recruit (\gls{spr}). SS3 searches for the $F\text{mult}$ that satisfies the search conditions, first for user-specified \gls{spr}, then for user-specified spawning biomass at a management target (B\textsubscript{TGT} or $F_{0.1}$), then for \gls{msy}. The resultant benchmark quantities are reported in the derived quantities, but $F\text{mult}$ and $F_{ben,f}'$ are only reported in the \texttt{Forecast\_report.sso} file. SS3 stores the benchmark $F\text{mult}$ values so that user can invoke them for the forecast.

%\myparagraph{Annual $F$}
%The $\text{ann}F$ is a single annual value across all fleets and areas according to F\_report\_units, which is specified by users in the starter file. If there are many fleets, across several areas and with very different selectivity patterns, $\text{ann}F$ can have a complicated relationship to $\text{apical\_}F$. The F\_report\_units specification in the starter.ss file, see example line below, allows user to calculate it using $F'$ directly, use exploitation rate, or be derived from $Z\text{-at-Age}$.
%
%Example $F$ reporting unit specification in the starter.ss file:
%
%\begin{center}
%	\begin{longtable}{p{2cm} p{12cm}}
%		\hline
%		5 & \# F\_report\_units:\Tstrut\\
%		  & 0 = skip; \\
%		  & 1 = exploitation(Bio); \\
%		  & 2 = exploitation(Num); \\ 
%		  & 3 = sum($F\text{rates}$); \\
%		  & 4 = true $F$ for range of ages; \\
%		  & 5 = unweighted avg. $F$ for range of ages. \Bstrut\\
%		\hline
%		3 7 & \# min and max age over which average $F$ will be calculated \Tstrut\Bstrut\\
%		\hline
%	\end{longtable}
%end{center}
%
%For options 4 and 5 of F\_report\_units, the $F$ is calculated as $Z-M$ where $Z$ is calculated as $ln(N_{t+1,a+1}/N_{t,a})$, thus $Z$ subsumes the effect of $F$.

%The $\text{ann}F$ is calculated for each year of the estimated time series and of the forecast. Additionally, an $\text{ann}F$ is calculated in the benchmark calculations to provide equilibrium values that have the same units as $\text{ann}F$ from the time series. In versions previous to v.3.30.15, it was labeled inaccurately as $F\text{\_std}$ in the output, not $\text{ann}F$. For example, in the Management Quantities section of derived quantities prior to v.3.30.15, there is a quantity labeled $F\text{std\_Btgt}$. This is more accurately labeled as the annual $F$ associated with the biomass target, $\text{ann\_}F\text{\_Btgt}$, in v.3.30.15.
%
%For example, if user selects option 1, $F$ / $F_\text{SPR}$, the time series of $\text{ann}F$ will be divided by each value by the ann$F$ calculated in benchmark.

\myparagraph{Additional Stock Synthesis inputs related to $F$}
Below is a list of items to consider in terms of units for $F$ in SS3:
\begin{itemize}
	\item If $F\text{\_ballpark}$ is specified in the \texttt{control.ss} file, its units are the same as $\text{ann}F$, so is not fleet-specific.
	\item $F$ as parameter values has units of fleet-specific $F'$.
	\item In the \texttt{forecast.ss} file there is an option to input a vector of $\text{rel}F$ values. These are dimensionless and will be rescaled to sum to 1.0.
	\item In the \texttt{forecast.ss} file there is an option to specify an $F$ scalar for the forecast. The units of $F$ scalar are the same as the $F\text{mult}$ values calculated in benchmark. There are a full set of options for forecast $F$ scalar that can be selected in the forecast file.
	%(-1 = none; 0 = simple; 1 = F\textsubscript{SPR}; 2 = F\textsubscript{MSY} 3 = F\textsubscript{BTGT} or F\textsubscript{0.1}; 4 = Ave F (uses first-last relative F years); and 5 = input annual F scalar). 
	If the forecast $F$ scalar is set as $F_\text{SPR}$, then SS3 will use $\text{SPR\_}F\text{mult}$ calculated in benchmark and reported in \texttt{Forecast-report.sso}. If user selects the option to input an annual $F$ scalar, option 5, then the value is input on a following line. Whichever method the user selects for forecast $F$ scalar ($F\text{mult}$), SS3 will start the forecast by creating a fleet-specific vector of $\text{full\_}F$ values from $F\text{mult}*\text{rel}F_f$.
	\item Also in the \texttt{forecast.ss} file, the last section of inputs allows for input of time and fleet specific $F_{t,f}'$ values that override the basic forecast $F$ specification described above.
\end{itemize}

\hypertarget{MSYandBenchmarks}{}
\subsubsection[MSY and other Benchmark Items]{\protect\hyperlink{MSYandBenchmarks}{MSY and other Benchmark Items}}
The following quantities are included in the sdreport vector mgmt\_quantities, so obtain estimates of variance. Some additional quantities can be found in the benchmarks section of the \texttt{forecast\_report.sso}.

\begin{center}
	\begin{longtable}{p{4cm} p{11cm}}
		\hline
		Benchmark Item & Description \Tstrut\Bstrut\\
		\hline
		\endfirsthead

		\hline
		Benchmark Item & Description \Tstrut\Bstrut\\
		\hline
		\endhead
		
		\endfoot
		\hline		
		\endlastfoot
		
		SSB\_Unfished \Tstrut & Unfished reproductive potential (gls{ssb} is commonly female mature spawning biomass). \\
		TotBio\_Unfished \Tstrut & Total age 0+ biomass on January 1. \\
		SmryBio\_Unfished \Tstrut & Biomass for ages at or above the summary age on January 1. \\
		Recr\_Unfished \Tstrut & Unfished recruitment. \\
		SSB\_Btgt \Tstrut & \gls{ssb} at user specified \gls{ssb} target. \\
		SPR\_Btgt \Tstrut & \gls{spr} at $F$ intensity that produces user specified \gls{ssb} target. \\
		Fstd\_Btgt \Tstrut & $F$ statistic at $F$ intensity that produces user specified \gls{ssb} target. \\
		TotYield\_Btgt \Tstrut & Total yield at $F$ intensity that produces user specified \gls{ssb} target. \\
		SSB\_SPRtgt \Tstrut & \gls{ssb} at user specified \gls{spr} target (but taking into account the spawner-recruitment relationship). \\
		Fstd\_SPRtgt \Tstrut & $F$ intensity that produces user specified \gls{spr} target. \\
		TotYield\_SPRtgt \Tstrut & Total yield at $F$ intensity that produces user specified \gls{spr} target. \\
		SSB\_MSY \Tstrut & \gls{ssb} at $F$ intensity that is associated with \gls{msy}; this $F$ intensity may be directly calculated to produce \gls{msy}, or can be mapped to $F_SPR$ or $F_Btgt$. \\
		SPR\_MSY \Tstrut & \gls{spr} at $F$ intensity associated with \gls{msy}. \\
		Fstd\_MSY \Tstrut & $F$ statistic at $F$ intensity associated with \gls{msy}. \\
		TotYield\_MSY \Tstrut & Total yield (biomass) at \gls{msy}. \\
		RetYield\_MSY \Tstrut & Retained yield (biomass) at \gls{msy}. \Bstrut\\ 
	\end{longtable}
\end{center}

\hypertarget{CumulativeOutput}{}
\subsection[Brief cumulative output]{\protect\hyperlink{CumulativeOutput}{Brief cumulative output}}
Cum\_Report.sso: contains a brief version of the run output, which is appended to current content of file so results of several runs can be collected together. This is especially useful when a batch of runs is being processed. Unless this file is deleted, it will contain a cumulative record of all runs done in that subdirectory. The first column contains the run number.  

\hypertarget{bootstrap}{}
\subsection[Bootstrap Data Files]{\protect\hyperlink{bootstrap}{Bootstrap Data Files}}
It is possible to create bootstrap data files for SS3 where an internal parametric bootstrap function generates a simulated data set by parametric bootstrap sampling the expected values given the input observation error. Starting in v.3.30.19, bootstrap data files are output separated in single numbered files (e.g., \texttt{data\_boot\_001.ss}). In version prior to v.3.30.19 a single file called \texttt{data.ss\_new} was output that contained multiple sections: the original data echoed out, the expected data values based on the model fit, and then subsequent bootstrap data files. 

Specifying the number of bootstrap data files has remained the same across model versions. Creating bootstrap data files is specified in the starter file via the ``Number of datafiles to produce'' line where a value of 3 or greater will create three files: the original data file, \texttt{data\_echo.ss\_new}, a data file with the model expected values, \texttt{data\_expval.ss}, and single bootstrap data file, \texttt{data\_boot\_001.ss}. The first output provides the unaltered input data file (with annotations added). The second provides the expected values for only the data elements used in the model run. The third and subsequent outputs provide parametric bootstraps around the expected values. 

The bootstrapping procedure within SS3 is done via the following steps:

\begin{itemize}
	\item Expected values of all input data are calculated (these are also used in the likelihood which compares observed to expected values for all data). The calculation of these expected values is described in detail under the ``Observation Model'' section of the appendix to \citet{methotstock2013}.
	
	\item Parametric bootstrap data are calculated for each observation by sampling from a probability distribution corresponding to the likelihood for that data type using the expected values noted above. Examples of how this happens include the following:
	
	\begin{itemize}
		\item Indices of abundance are sampled from the distribution used in the estimation model (as set in the ``Errtype'' column of the index configuration, most commonly log-normal but could be normal or T-distribution). The variability of the distribution from which the random sample is drawn is based on the combination of the input uncertainty and any estimated ``Extra SD'' parameter and any ``add\_to\_survey\_CV'' value included under the input variance adjustments factors.
		
		\item Length and age compositions are sampled from multinomial distributions with expected proportions in each bin based on the expected values and sample size equal to the adjusted input sample size (input sample size multiplied by any inputs for ``mult\_by\_lencomp\_N'' or ``mult\_by\_agecomp\_N'' under the input variance adjustments factors).
		
		\item Discard data (fractions or absolute amounts) are generated from the chosen distribution (T-distribution, normal, log-normal, truncated-normal).
		
		\item Tagging data is generated using a negative binomial distribution to get the total number of recaptures for each tag group and a multinomial distribution to allocate those recaptures among fleets.
	\end{itemize}
\end{itemize}

Given this, there are some assumptions implicit in the bootstrapping procedure (as implemented as of v.3.30.17) that users should be aware of:

\begin{itemize}

	\item This procedure is strictly an observation error approach (i.e., process error in recruitment or any other time-varying parameter is not added). For simulation analyses, a common approach has been to input a new time series of recruitment deviations for each bootstrap data set.
	
	\item The sample size for conditional age-at-length data matches the inputs for each length bin. If stratified sampling is used, this may be appropriate, but if the ages represent a random subset of the selected population, this may result in less variability than if the associated length distribution were resampled.
	
	\item Currently, the aging error matrix is multiplied by the expected distribution of proportions at age, while the more correct order of operations would be to sample true ages, and then sample the observed age including aging error (it is possible these are mathematically identical).
	
	\item Often there is need to explore the removal (not include in the model fitting) of specific years in a data set which can be done by specifying a negative fleet number. If bootstrapping a data file, note that specifying a negative fleet in the data inputs for indices, length composition, or age composition will include the ``observation'' in the model (hence generating predicted values and bootstrap data sets for the data), but not in the negative log likelihood. The ``observation values'' used with negative fleet do not influence the predicted values, except when using tail compression with length or age composition. Non-zero values greater than the minimum tail compression should be used for the observation values when tail compression is being used, as using zeros or values smaller than the minimum tail compression can cause the predicted values to be reported as zero and shift predictions to other bins.
	
	\item As of v.3.30.15, age and length composition data that use the Dirichlet-multinomial distribution in the model are generated using the Dirichlet-multinomial in bootstrap data sets.
	
\end{itemize}

\hypertarget{ForecastRefPoints}{}
\subsection[Forecast and Reference Points (\texttt{Forecast-report.sso})]{\protect\hyperlink{ForecastRefPoints}{Forecast and Reference Points (\texttt{Forecast-report.sso})}}
The Forecast-report file contains output of fishery reference points and forecasts. It is designed to meet the needs of the Pacific Fishery Management Council's Groundfish Fishery Management Plan, but it should be quite feasible to develop other regionally specific variants of this output.

The vector of forecast recruitment deviations is estimated during an additional model estimation phase. This vector includes any years after the end of the recruitment deviation time series and before or at the end year. When this vector starts before the ending year of the time series, then the estimates of these recruitments will be influenced by the data in these final years. This is problematic, because the original reason for not estimating these recruitments at the end of the time series was the poor signal/noise ratio in the available data. It is not that these data are worse than data from earlier in the time series, but the low amount of data accumulated for each cohort allows an individual datum to dominate the model's fit. Thus, an additional control is provided so that forecast recruitment deviations during these years can receive an extra weighting in order to counter-balance the influence of noisy data at the end of the time series.

An additional control is provided for the fraction of the log-bias adjustment to apply to the forecast recruitments. Recall that R is the expected mean level of recruitment for a particular year as specified by the spawner-recruitment curve and R' is the geometric mean recruitment level calculated by discounting R with the log-bias correction factor $e-0.5s^2$. Thus, a log-normal distribution of recruitment deviations centered on R' will produce a mean level of recruitment equal to R. During the modeled time series, the virgin recruitment level and any recruitments prior to the first year of recruitment deviations are set at the level of R, and the log-normal recruitment deviations are centered on the R' level. For the forecast recruitments, the fraction control can be set to 1.0 so that 100\% of the log-bias correction is applied and the forecast recruitment deviations will be based on the R' level. This is certainly the configuration to use when the model is in \gls{mcmc} mode. Setting the fraction to 0.0 during maximum likelihood forecasts would center the recruitment deviations, which all have a value of 0.0 in maximum likelihood mode, on R. Thus would provide a mean forecast that would be more comparable to the mean of the ensemble of forecasts produced in \gls{mcmc} mode. Further work on this topic is underway.

Note:
\begin{itemize}
	\item Cohorts continue growing according to their specific growth parameters in the forecast period rather than staying static at the end year values.
	\item Environmental data entered for future years can be used to adjust expected recruitment levels. However, environmental data will not affect growth or selectivity parameters in the forecast.
\end{itemize}

The top of the Forecast-report file shows the search for $F_{SPR}$ and the search for $F_{MSY}$, allowing the user to verify convergence. Note: if the STD file shows aberrant results, such as all the standard deviations being the same value for all recruitments, then check the $F_{MSY}$ search for convergence. The $F_{MSY}$ can be calculated, or set equal to one of the other $F$ reference points per the selection made in \texttt{starter.ss}.

\hypertarget{MainOutput}{}
\subsection[Main Output File, \texttt{Report.sso}]{\protect\hyperlink{MainOutput}{Main Output File, \texttt{Report.sso}}}
This is the primary output file. Its major sections (as of v.3.30.16) are listed below.  

The sections of the output file are:
\begin{itemize}
	\item SS3 version number with date compiled. Time and date of model run. This info appears at the top of all output files.
	\item Comments
		\begin{itemize}
			\item Input file lines starting with \#C are echoed here.
		\end{itemize}
	\item Keywords
		\begin{itemize}
			\item List of keywords used in searching for output sections.
		\end{itemize}
	\item Definitions
		\begin{itemize}
			\item List of definitions (e.g., fleet names, model start year) assigned in the data and control files.
		\end{itemize}
	\item Likelihood
		\begin{itemize}
			\item Final values of the negative log likelihood are presented.
		\end{itemize}
	\item Input Variance Adjustments
		\begin{itemize}
			\item The matrix of input variance adjustments is output here because these values affect the log likelihood calculations.
		\end{itemize}
	\item{Parm deviations detail}
	    \begin{itemize}
		    \item Details about parameter deviations, if used in the model. Will be missing if no parameter devs were used.
		\end{itemize}
	\item Parameters
		\begin{itemize}
			\item The parameters are listed here. For the estimated parameters, the display shows: Num (count of parameters), Label (as internally generated by SS3), Value, Active\_Cnt, Phase, Min, Max, Init, Prior, Prior\_type, Prior\_SD, Prior\_Like, Parm\_StD (standard deviation of parameter as calculated from inverse Hessian), Status (e.g., near bound), and Pr\_atMin (value of prior penalty if parameter was near bound). The Active\_Cnt entry is a count of the parameters in the same order they appear in the \texttt{ss.cor} file.
		\end{itemize}
	\item Derived Quantities
		\begin{itemize}
			\item This section starts by showing the options selected from the \texttt{starter.ss} and \texttt{forecast.ss} input files:
				\begin{itemize}
					\item \gls{spr} ratio basis
					\item $F$ report basis
					\item B ratio denominator
				\end{itemize}
		\end{itemize}
\end{itemize}

Then the time series of output, with standard deviation of estimates, are produced with internally generated labels. Note that these time series extend through the forecast era. The order of the output is: spawning biomass, recruitment, SPRratio, Fratio, Bratio, management quantities, forecast catch (as a target level), forecast catch as a limit level (\gls{ofl}), Selex\_std, Grow\_std, NatAge\_std. For the three ``ratio'' quantities, there is an additional column of output showing a Z-score calculation of the probability that the ratio differs from 1.0. The ``management quantities'' section is designed to meet the terms of reference for west coast groundfish assessments; other formats could be made available upon request. The standard deviation quantities at the end are set up according to specifications at the end of the control input file. In some cases, a user may specify that no derived quantity output of a certain type be produced. In those cases, SS3 substitutes a repeat output of the virgin spawning biomass so that vectors of null length are not created.

\begin{itemize}
	\item Mortality and growth parameters by year after adjustments
	\begin{itemize}
		\item This block shows the time series of mortality and growth parameters by year after adjustments by environmental links, blocks and deviations.
	\end{itemize}
	\item Selectivity parameters (size) by year after adjustments
	\begin{itemize}
		\item This block shows the size selectivity parameters, after adjustment, for each year in which a change occurs.
	\end{itemize}
	\item Selectivity parameters (age) by year after adjustments
	\begin{itemize}
		\item This block shows the age selectivity parameters, after adjustment, for each year in which a change occurs.
	\end{itemize}
	\item Recruitment Distribution
	\begin{itemize}
		\item This block shows the distribution of recruitment across growth patterns, sexes, birth seasons, and areas in the end year of the model.
	\end{itemize}
	\item Growth Morph Indexing
	\begin{itemize}
		\item This block shows the internal index values for various quantities. It can be a useful reference for complex model setups. The vocabulary is: Bio\_Pattern refers to a collection of cohorts with the same defined growth and natural mortality parameters; sex is the next main index. If recruitment occurs in multiple seasons, then birth season is the index for that factor. The index labeled ``Platoon'' is used as a continuous index across all the other factor-specific indices. If sub-platoons are used, they are nested within the Bio\_Pattern x Sex x Birth Season platoon. However, some output tables use the column label ``platoon'' as a continuous index across platoons and sub-platoons. Note that there is no index here for area. Each of the cohorts is distributed across areas and they retain their biological characteristics as they move among areas.
	\end{itemize}
	\item Size Frequency Translation
	\begin{itemize}
		\item If the generalized size frequency approach is used, this block shows the translation probabilities between population length bins and the units of the defined size frequency method. If the method uses body weight as the accumulator, then output is in corresponding units.
	\end{itemize}
	\item Movement
	\begin{itemize}
		\item This block shows movement rate between areas in a multi-area model.
	\end{itemize}
	\item Exploitation
	\begin{itemize}
		\item This block shows the time series of the selected $F\text{\_std}$ unit and the $F$ multiplier for each fleet in terms of harvest rate (if Pope's approximation is used) or fully selected $F$.
	\end{itemize}
	\item Catch
	\item Time Series
	\item SPR Series
	\item Kobe Plot
	\begin{itemize}
	    \item Reports output in a table needed to create a Kobe Plot.
    \end{itemize}
	\item Spawn Recruit Parameters and Table
	\begin{itemize}
	    \item Extensive information on Spawn-recruit parameter values and derived quantities.
	\end{itemize}
	\item Spawn Recruit Curve
		\begin{itemize}
	    \item A table containing information to recreate the spawn-recruit curve. 
	\end{itemize}
	\item Index 1
	\item Index 2
	\begin{itemize}
		\item This section reports the observed and expected values for each index. All are reported in one list with index number included as a selection field. At the bottom of this section, the root mean squared error of the fit to each index is compared to the mean input error level to assist the user in gauging the goodness-of-fit and potentially adjusting the input level of imprecision.
	\end{itemize}
	\item Index 3
	\begin{itemize}
		\item This section shows the parameter number assigned to each parameter used in this section.
	\end{itemize}
	\item Discard Specification
	\item Discard Output
	\begin{itemize}
		\item This is the list of observed and expected values for the amount (or fraction) discard.
	\end{itemize}
	\item Mean Body Wt
	\begin{itemize}
		\item This is the list of observed and expected values for the mean body weight.
	\end{itemize}
	\item Fit Len Comps
	\begin{itemize}
		\item This is the list of the goodness of fit to the length compositions. The input and output levels of effective sample size are shown as a guide to adjusting the input levels to better match the model's ability to replicate these observations.
	\end{itemize}
	\item Fit Age Comps
	\begin{itemize}
		\item This has the same format as the length composition section.
	\end{itemize}
	\item Fit Size Comps
	\begin{itemize}
		\item This has the same format as the length composition section and is used for the generalized size composition summary.
	\end{itemize}
	\item Overall Comps
	\item Len Selex
	\begin{itemize}
		\item Here is the length selectivity and other length specific quantities for each fishery and survey.
	\end{itemize}
	\item Age Selex
	\begin{itemize}
		\item Here is reported the time series of age selectivity and other age-related quantities for each fishery and survey. Some are directly computed in terms of age, and others are derived from the combination of a length-based factor and the distribution of size-at-age.
	\end{itemize}
	\item Environmental Data
	\begin{itemize}
		\item The input values of environmental data are echoed here. Density-dependence can be used by linking to population quantities that have already been calculated at the start of the year. These include summary biomass, spawning biomass, and recruitment deviations. These three quantities are mapped into the -1, -2, and -3 columns of the environmental data matrix where they can be used as if there were environmental data input. 
	\end{itemize}
	\item Tag Recapture Information
	\item Numbers at Age
	\begin{itemize}
		\item The output (in thousands of fish) is shown for each cohort tracked in the model.
	\end{itemize}
	\item Biomass at Age
	\item Numbers at Length
	\begin{itemize}
		\item The output is shown for each cohort tracked in the model.
	\end{itemize}
	\item Biomass at Length
	\item $F$ at Age
	\item Catch at Age
	\begin{itemize}
		\item The output is shown for each fleet. It is not necessary to show by area because each fleet operates in only one area.
	\end{itemize}
	\item Discard at Age
	\item Biology
	\begin{itemize}
		\item The first biology section shows the length-specific quantities in the ending year of the time series only. The derived quantity spawn is the product of female body weight, maturity and fecundity per weight. The second section shows natural mortality.
	\end{itemize}
	\item Natural Mortality
	\item Age-specific K
	\item Growth Parameters
	\begin{itemize}
		\item This section shows the growth parameters, and associated derived quantities, for each year in which a change is estimated.
	\end{itemize}
	\item Seasonal Effects
	\item Biology at Age
	\begin{itemize}
		\item This section shows derived size-at-age and other quantities. As of v.3.30.21 sex ratio is reported by area in this output table.
	\end{itemize}
	\item Mean Body Wt (begin)
	\begin{itemize}
		\item This section reports the time series of mean body weight for each platoon. Values shown are for the beginning of each season of each year.
	\end{itemize}
	\item Mean Size Time series
	\begin{itemize}
		\item This section shows the time series of mean length-at-age for each platoon. At the bottom is the average mean size as the weighted average across all platoons for each sex.
	\end{itemize}
	\item Age Length Key
	\begin{itemize}
		\item This is reported for the midpoint of each season in the ending year.
	\end{itemize}
	\item Age Age Key
	\begin{itemize}
		\item This is the calculated distribution of observed ages for each true age for each of the defined ageing keys.
	\end{itemize}
	\item Composition Database
	\begin{itemize}
		\item Contains the length composition, age composition, and mean size-at-age observed and expected values. It is arranged in a database format, rather than an array of vectors.
	\end{itemize}
	\item Selectivity Database
	\begin{itemize}
		\item This section contains the selectivities organized as a database, rather than as a set of vectors.
	\end{itemize}
	\item \gls{SPR}/\gls{YPR} Profile
	\item Global \gls{MSY} Report
	\item Dynamic Bzero Report
\end{itemize}

\pagebreak
